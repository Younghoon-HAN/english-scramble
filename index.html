<!DOCTYPE html>

<html lang="ko">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>AI Scramble - ëª©ì ê²© ê´€ê³„ëŒ€ëª…ì‚¬</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap" rel="stylesheet">

    <style>

        body { font-family: 'Pretendard', sans-serif; transition: all 0.3s; }

        .dark { background-color: #0f172a; color: #f1f5f9; }

        .word-tile { transition: all 0.2s; cursor: pointer; user-select: none; }

        .word-tile.selected { opacity: 0.3; pointer-events: none; }

        .drop-zone { min-height: 80px; border: 2px dashed #e2e8f0; border-radius: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem; }

        .dark .drop-zone { border-color: #334155; background-color: #1e293b; }

        .correct { border-color: #22c55e !important; background-color: #f0fdf4 !important; }

        .incorrect { border-color: #ef4444 !important; background-color: #fef2f2 !important; }

        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 100; align-items: center; justify-content: center; padding: 1rem; }

        .modal.active { display: flex; }

    </style>

</head>

<body class="bg-slate-50 min-h-screen flex flex-col items-center p-4">



    <!-- 1. ë¡œê·¸ì¸ ëª¨ë‹¬ (í•„ìˆ˜ ì…ë ¥) -->

    <div id="login-modal" class="modal active">

        <div class="bg-white dark:bg-slate-800 w-full max-w-md rounded-[2.5rem] p-10 shadow-2xl text-center border border-slate-100">

            <div class="mb-6">

                <span class="px-4 py-1.5 bg-indigo-100 text-indigo-600 rounded-full text-xs font-bold tracking-widest uppercase">Grammar Master</span>

            </div>

            <h2 class="text-3xl font-black text-slate-800 dark:text-white mb-2">ëª©ì ê²© ê´€ê³„ëŒ€ëª…ì‚¬</h2>

            <p class="text-slate-500 dark:text-slate-400 mb-8">í•™ìŠµì„ ì‹œì‘í•˜ë ¤ë©´ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.</p>

            

            <input type="text" id="user-nickname" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" 

                   class="w-full p-4 rounded-2xl border border-slate-200 dark:border-slate-700 dark:bg-slate-900 mb-4 outline-none focus:ring-4 focus:ring-indigo-500/20 text-center font-bold text-lg">

            

            <button id="start-btn" class="w-full py-4 bg-indigo-600 text-white rounded-2xl font-black text-lg hover:bg-indigo-700 transition-all shadow-xl shadow-indigo-200 active:scale-95">í•™ìŠµ ì‹œì‘í•˜ê¸°</button>

            

            <p class="mt-6 text-xs text-slate-400">ì…ë ¥í•˜ì‹  ì´ë¦„ìœ¼ë¡œ ì‹¤ì‹œê°„ ìˆœìœ„ê°€ ê¸°ë¡ë©ë‹ˆë‹¤.</p>

        </div>

    </div>



    <!-- 2. ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (ì‚¬ìš©ì ì •ë³´ í‘œì‹œ) -->

    <nav class="w-full max-w-2xl flex justify-between items-center mb-6 py-2 px-4">

        <div class="flex items-center gap-3">

            <div id="user-avatar" class="w-11 h-11 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center text-white font-black shadow-lg">?</div>

            <div>

                <p id="display-name" class="text-sm font-black dark:text-white">ì ‘ì† ëŒ€ê¸° ì¤‘</p>

                <div class="flex items-center gap-1.5">

                    <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>

                    <p class="text-[11px] font-bold text-slate-400 uppercase tracking-tighter">Live Syncing</p>

                </div>

            </div>

        </div>

        <div class="flex gap-2.5">

            <button id="rank-btn" class="p-3 rounded-2xl bg-white dark:bg-slate-800 shadow-sm border border-slate-200 dark:border-slate-700 hover:bg-slate-50 transition-all">ğŸ† ìˆœìœ„í‘œ</button>

            <button id="admin-btn" class="p-3 rounded-2xl bg-white dark:bg-slate-800 shadow-sm border border-slate-200 dark:border-slate-700 hover:bg-slate-50 transition-all">âš™ï¸</button>

        </div>

    </nav>



    <!-- 3. ë©”ì¸ ê²Œì„ ì˜ì—­ -->

    <main id="game-container" class="w-full max-w-2xl bg-white dark:bg-slate-800 shadow-2xl rounded-[3rem] p-8 md:p-12 transition-all border border-slate-100 dark:border-slate-700 relative overflow-hidden">

        <div class="flex justify-between items-start mb-8">

            <div class="flex-1">

                <div id="level-badge" class="inline-block px-3 py-1 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded-lg text-[10px] font-black uppercase tracking-widest mb-3">Sentence 1</div>

                <h2 id="translation" class="text-2xl md:text-3xl font-black text-slate-800 dark:text-white leading-tight">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</h2>

            </div>

            <div class="bg-slate-50 dark:bg-slate-900 p-4 rounded-[1.5rem] text-center min-w-[100px] border border-slate-100 dark:border-slate-800">

                <p class="text-[10px] font-black text-slate-400 uppercase mb-1">My Score</p>

                <p id="score-display" class="text-3xl font-black text-indigo-600 dark:text-indigo-400">0</p>

            </div>

        </div>



        <div class="w-full bg-slate-100 dark:bg-slate-700 h-2.5 rounded-full mb-10 overflow-hidden">

            <div id="progress-bar" class="bg-gradient-to-r from-indigo-500 to-purple-600 h-full w-0 transition-all duration-700 ease-out"></div>

        </div>



        <div class="mb-8">

            <div class="flex justify-between mb-3">

                <p class="text-[11px] font-black text-slate-400 uppercase tracking-widest">Answer Zone</p>

                <p class="text-[11px] font-bold text-indigo-500 uppercase">Click tiles to remove</p>

            </div>

            <div id="answer-zone" class="drop-zone p-5 bg-slate-50/50"></div>

        </div>



        <div class="mb-12">

            <p class="text-[11px] font-black text-slate-400 uppercase tracking-widest mb-4">Word Pool</p>

            <div id="word-pool" class="flex flex-wrap gap-2.5 justify-center min-h-[80px]"></div>

        </div>



        <div class="grid grid-cols-2 gap-4">

            <button id="reset-btn" class="py-5 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-[1.5rem] font-black hover:bg-slate-200 transition-all">ì´ˆê¸°í™”</button>

            <button id="check-btn" class="py-5 bg-indigo-600 text-white rounded-[1.5rem] font-black shadow-lg shadow-indigo-100 hover:bg-indigo-700 active:scale-95 transition-all">ì •ë‹µ í™•ì¸</button>

            <button id="next-btn" class="hidden col-span-2 py-5 bg-emerald-500 text-white rounded-[1.5rem] font-black shadow-lg shadow-emerald-100 hover:bg-emerald-600 transition-all">ë‹¤ìŒ ë¬¸ì¥ìœ¼ë¡œ</button>

        </div>

        <div id="feedback" class="mt-8 text-center font-black text-xl opacity-0 transition-all h-8">ì •ë‹µì…ë‹ˆë‹¤!</div>

    </main>



    <!-- 4. ìˆœìœ„í‘œ ëª¨ë‹¬ -->

    <div id="rank-modal" class="modal">

        <div class="bg-white dark:bg-slate-800 w-full max-w-md rounded-[2.5rem] p-10 shadow-2xl relative">

            <button id="rank-close" class="absolute top-6 right-6 w-10 h-10 flex items-center justify-center bg-slate-100 dark:bg-slate-700 rounded-full text-slate-500 hover:bg-slate-200">&times;</button>

            <h3 class="text-2xl font-black mb-8 dark:text-white flex items-center gap-3">ğŸ† ì‹¤ì‹œê°„ ìˆœìœ„í‘œ</h3>

            <div id="rank-list" class="space-y-3 max-h-[400px] overflow-y-auto pr-2">

                <p class="text-center py-10 text-slate-400">ìˆœìœ„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>

            </div>

        </div>

    </div>



    <!-- 5. ê´€ë¦¬ì/AI ìƒì„± ëª¨ë‹¬ -->

    <div id="admin-modal" class="modal">

        <div class="bg-white dark:bg-slate-800 w-full max-w-2xl rounded-[2.5rem] p-10 shadow-2xl max-h-[90vh] overflow-y-auto">

            <div class="flex justify-between items-center mb-8">

                <h3 class="text-2xl font-black dark:text-white font-black">AI ë¬¸ì¥ ìƒì„± & ê´€ë¦¬</h3>

                <button id="admin-close" class="text-2xl text-slate-400">&times;</button>

            </div>

            

            <div class="bg-indigo-50 dark:bg-indigo-900/20 p-6 rounded-[2rem] border border-indigo-100 dark:border-indigo-800 mb-8">

                <p class="text-indigo-600 font-black text-sm mb-4 uppercase tracking-tighter italic">âœ¨ AI Generation Power</p>

                <div class="flex gap-2">

                    <input type="text" id="ai-prompt" placeholder="ì˜ˆ: ëª©ì ê²© ê´€ê³„ëŒ€ëª…ì‚¬ê°€ í¬í•¨ëœ ìš°ì£¼ í…Œë§ˆ ë¬¸ì¥ 5ê°œ" 

                           class="flex-1 p-4 rounded-2xl border-none shadow-inner dark:bg-slate-900 outline-none focus:ring-2 focus:ring-indigo-500">

                    <button id="generate-ai-btn" class="px-8 bg-indigo-600 text-white rounded-2xl font-black hover:bg-indigo-700 disabled:opacity-50">ìƒì„±</button>

                </div>

            </div>



            <div id="admin-quiz-list" class="space-y-3">

                <!-- í˜„ì¬ ë¬¸ì¥ ëª©ë¡ -->

            </div>

        </div>

    </div>



    <!-- Firebase ë° ë¡œì§ ìŠ¤í¬ë¦½íŠ¸ -->

    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";

        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        import { getFirestore, doc, setDoc, getDoc, collection, onSnapshot, updateDoc, increment, deleteDoc, writeBatch } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";



        const firebaseConfig = {

            apiKey: "AIzaSyA3j1y-fDVwULntoBFIVmGlLhROSyk7yRs",

            authDomain: "english-scramble.firebaseapp.com",

            projectId: "english-scramble",

            storageBucket: "english-scramble.firebasestorage.app",

            messagingSenderId: "1051575656252",

            appId: "1:1051575656252:web:1a25ee13efbe8dc47fc839",

            measurementId: "G-L92WNLFTHZ"        };



        const GEMINI_API_KEY = "AIzaSyAW3PAPC5lBZvqR_xUN0Tr1y3eS-Oe3uPc"; 





        const app = initializeApp(firebaseConfig);

        const auth = getAuth(app);

        const db = getFirestore(app);

        const appId = 'scramble-pro-v3';



        // ê¸°ë³¸ í€´ì¦ˆ ë°ì´í„° (DBê°€ ë¹„ì–´ìˆì„ ë•Œ ì‚¬ìš©)

        let quizzes = [

            { en: "Gazzaniga then asked participants why they chose the card that they did", ko: "GazzanigaëŠ” ê·¸ë‹¤ìŒ ì°¸ê°€ìë“¤ì—ê²Œ ì™œ ê·¸ë“¤ì´ ê·¸ ì¹´ë“œë¥¼ ì„ íƒí–ˆëŠ”ì§€ë¥¼ ë¬¼ì—ˆë‹¤." },

            { en: "the tariff that protects steelworkers raises the price of the steel that domestic automobile makers need to build their cars", ko: "ì² ê°• ë…¸ë™ìë¥¼ ë³´í˜¸í•˜ëŠ” ê´€ì„¸ëŠ” êµ­ë‚´ ìë™ì°¨ ì œì¡°ì—…ì²´ë“¤ì´ ìë™ì°¨ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ í•„ìš”í•œ ì² ê°•ì˜ ê°€ê²©ì„ ìƒìŠ¹ì‹œí‚¨ë‹¤." },

            { en: "our brains experience a sense of reward when we create something new in the process of exploring something uncertain, such as a musical phrase that weâ€™ve never played or heard before", ko: "ìš°ë¦¬ì˜ ë‡ŒëŠ” í•œ ë²ˆë„ ì—°ì£¼í•˜ê±°ë‚˜ ë“¤ì–´ë³¸ ì  ì—†ëŠ” ìŒì•… êµ¬ì ˆì²˜ëŸ¼, ë¶ˆí™•ì‹¤í•œ ê²ƒì„ íƒìƒ‰í•˜ëŠ” ê³¼ì •ì—ì„œ ìƒˆë¡œìš´ ë¬´ì–¸ê°€ë¥¼ ë§Œë“¤ì–´ë‚¼ ë•Œ ë³´ìƒì˜ ê°ê°ì„ ê²½í—˜í•œë‹¤." },

            { en: "mental development consists of individuals increasingly mastering social codes and signals themselves, which they can master only in social situations with the support of more competent individuals, typically adults", ko: "ì •ì‹  ë°œë‹¬ì´ë€ ê°œì¸ì´ ì‚¬íšŒì  ê·œë²”ê³¼ ì‹ í˜¸ë¥¼ ì ì  ë” ìŠ¤ìŠ¤ë¡œ ìŠµë“í•´ ê°€ëŠ” ê³¼ì •ì´ë©°, ì´ëŸ¬í•œ ê²ƒë“¤ì€ ë³´í†µ ì„±ì¸ê³¼ ê°™ì€ ë” ìœ ëŠ¥í•œ ì‚¬ëŒë“¤ì˜ ë„ì›€ì„ ë°›ëŠ” ì‚¬íšŒì  ìƒí™©ì—ì„œë§Œ ìŠµë“í•  ìˆ˜ ìˆë‹¤." },

            { en: "by clarifying the nature of the old and new perspectives, and by identifying actions on which we might cooperate to move the process along, we can help accelerate the shift", ko: "ê¸°ì¡´ ê´€ì ê³¼ ìƒˆë¡œìš´ ê´€ì ì˜ ì„±ê²©ì„ ë¶„ëª…íˆ í•˜ê³ , ê·¸ ê³¼ì •ì„ ì§„ì „ì‹œí‚¤ê¸° ìœ„í•´ ìš°ë¦¬ê°€ í˜‘ë ¥í•  ìˆ˜ ìˆëŠ” í–‰ë™ë“¤ì„ ì°¾ì•„ë‚¸ë‹¤ë©´, ìš°ë¦¬ëŠ” ê·¸ ì „í™˜ì„ ê°€ì†í™”í•˜ëŠ” ë° ë„ì›€ì„ ì¤„ ìˆ˜ ìˆë‹¤." }

        ];

        let currentIdx = 0;

        let selectedWords = [];

        let currentUser = null;



        const ui = {

            loginModal: document.getElementById('login-modal'),

            nicknameInput: document.getElementById('user-nickname'),

            startBtn: document.getElementById('start-btn'),

            displayName: document.getElementById('display-name'),

            scoreDisplay: document.getElementById('score-display'),

            translation: document.getElementById('translation'),

            answerZone: document.getElementById('answer-zone'),

            wordPool: document.getElementById('word-pool'),

            feedback: document.getElementById('feedback'),

            checkBtn: document.getElementById('check-btn'),

            nextBtn: document.getElementById('next-btn'),

            progressBar: document.getElementById('progress-bar'),

            rankList: document.getElementById('rank-list')

        };



        // 1. ë¡œê·¸ì¸ ì²˜ë¦¬

        ui.startBtn.onclick = async () => {

            const nickname = ui.nicknameInput.value.trim();

            if (!nickname) {

                alert("ì´ë¦„ì„ ì…ë ¥í•´ì•¼ ì ìˆ˜ê°€ ì €ì¥ë©ë‹ˆë‹¤!");

                return;

            }



            ui.startBtn.disabled = true;

            ui.startBtn.innerText = "ì ‘ì† ì¤‘...";



            try {

                const cred = await signInAnonymously(auth);

                const userRef = doc(db, 'artifacts', appId, 'public', 'data', 'users', cred.user.uid);

                

                await setDoc(userRef, {

                    nickname: nickname,

                    score: 0,

                    lastUpdated: Date.now()

                }, { merge: true });



                ui.loginModal.classList.remove('active');

                // ë¡œê·¸ì¸ ì§í›„ ê²Œì„ ë¡œë“œ ê°•ì œ ì‹¤í–‰

                loadQuiz(); 

            } catch (e) {

                console.error(e);

                alert("ì ‘ì† ì‹¤íŒ¨: Firebase ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.");

                ui.startBtn.disabled = false;

                ui.startBtn.innerText = "í•™ìŠµ ì‹œì‘í•˜ê¸°";

            }

        };



        // 2. ì¸ì¦ ê°ì§€ ë° ì´ˆê¸°í™”

        onAuthStateChanged(auth, (user) => {

            if (user) {

                currentUser = user;

                onSnapshot(doc(db, 'artifacts', appId, 'public', 'data', 'users', user.uid), (snap) => {

                    if (snap.exists()) {

                        const data = snap.data();

                        ui.displayName.innerText = data.nickname;

                        ui.scoreDisplay.innerText = data.score;

                        document.getElementById('user-avatar').innerText = data.nickname.charAt(0);

                    }

                });

                setupSync();

            }

        });



        // 3. ë°ì´í„° ë™ê¸°í™”

        function setupSync() {

            onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'quizzes'), (snap) => {

                const cloudQuizzes = [];

                snap.forEach(doc => cloudQuizzes.push({ id: doc.id, ...doc.data() }));

                

                if (cloudQuizzes.length > 0) {

                    quizzes = cloudQuizzes.sort((a, b) => (a.createdAt || 0) - (b.createdAt || 0));

                }

                

                loadQuiz();

                updateAdminList();

            });



            onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'users'), (snap) => {

                const users = [];

                snap.forEach(doc => users.push({ id: doc.id, ...doc.data() }));

                users.sort((a, b) => b.score - a.score);

                

                ui.rankList.innerHTML = users.map((u, i) => `

                    <div class="flex justify-between items-center p-4 ${u.id === currentUser?.uid ? 'bg-indigo-50 border border-indigo-200 ring-4 ring-indigo-500/10' : 'bg-slate-50'} rounded-2xl transition-all">

                        <div class="flex items-center gap-4">

                            <span class="text-lg font-black ${i < 3 ? 'text-indigo-600' : 'text-slate-300'}">${i + 1}</span>

                            <span class="font-bold text-slate-700">${u.nickname} ${u.id === currentUser?.uid ? '(ë‚˜)' : ''}</span>

                        </div>

                        <span class="font-black text-indigo-600">${u.score}ì </span>

                    </div>

                `).join('');

            });

        }



        // 4. ê²Œì„ ë¡œì§

        function loadQuiz() {

            if (!currentUser || quizzes.length === 0) return;

            

            const quiz = quizzes[currentIdx % quizzes.length];

            ui.translation.innerText = quiz.ko;

            ui.progressBar.style.width = `${((currentIdx + 1) / quizzes.length) * 100}%`;

            document.getElementById('level-badge').innerText = `SENTENCE ${currentIdx + 1} / ${quizzes.length}`;

            

            ui.answerZone.innerHTML = '';

            ui.answerZone.classList.remove('correct', 'incorrect');

            ui.feedback.style.opacity = '0';

            ui.nextBtn.classList.add('hidden');

            ui.checkBtn.classList.remove('hidden');

            selectedWords = [];



            const words = quiz.en.split(/\s+/).filter(w => w.length > 0);

            const shuffled = [...words].sort(() => Math.random() - 0.5);



            ui.wordPool.innerHTML = '';

            shuffled.forEach((word) => {

                const btn = document.createElement('div');

                btn.className = 'word-tile bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 px-5 py-4 rounded-[1.2rem] font-bold text-slate-700 dark:text-slate-200 shadow-sm hover:shadow-md hover:border-indigo-400 active:scale-90 transition-all';

                btn.innerText = word;

                btn.onclick = () => {

                    btn.classList.add('selected');

                    const tile = document.createElement('div');

                    tile.className = 'word-tile bg-indigo-600 text-white px-5 py-4 rounded-[1.2rem] font-bold shadow-lg shadow-indigo-200 animate-in fade-in zoom-in duration-200';

                    tile.innerText = word;

                    tile.onclick = () => {

                        btn.classList.remove('selected');

                        tile.remove();

                        selectedWords = selectedWords.filter(item => item.tile !== tile);

                    };

                    ui.answerZone.appendChild(tile);

                    selectedWords.push({ word, tile });

                };

                ui.wordPool.appendChild(btn);

            });

        }



        ui.checkBtn.onclick = async () => {

            if (selectedWords.length === 0) return;

            const userSentence = selectedWords.map(w => w.word.toLowerCase().replace(/[.,!?;]/g, "")).join(' ');

            const correctSentence = quizzes[currentIdx % quizzes.length].en.toLowerCase().replace(/[.,!?;]/g, "").trim();



            if (userSentence === correctSentence) {

                ui.feedback.innerText = "ì •ë‹µì…ë‹ˆë‹¤! +10ì  ì €ì¥ ì¤‘...";

                ui.feedback.className = "mt-8 text-center font-black text-xl text-emerald-500 opacity-100";

                ui.answerZone.classList.add('correct');

                

                if (currentUser) {

                    await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'users', currentUser.uid), {

                        score: increment(10),

                        lastUpdated: Date.now()

                    });

                }



                ui.checkBtn.classList.add('hidden');

                ui.nextBtn.classList.remove('hidden');

            } else {

                ui.feedback.innerText = "ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•´ë³´ì„¸ìš”!";

                ui.feedback.className = "mt-8 text-center font-black text-xl text-red-500 opacity-100";

                ui.answerZone.classList.add('incorrect');

                setTimeout(() => ui.answerZone.classList.remove('incorrect'), 800);

            }

        };



        ui.nextBtn.onclick = () => {

            currentIdx = (currentIdx + 1) % quizzes.length;

            loadQuiz();

        };



        // 5. ê´€ë¦¬ ê¸°ëŠ¥

        document.getElementById('generate-ai-btn').onclick = async () => {

            const prompt = document.getElementById('ai-prompt').value.trim();

            if (!prompt || !GEMINI_API_KEY) return alert("í”„ë¡¬í”„íŠ¸ì™€ API í‚¤ë¥¼ í™•ì¸í•˜ì„¸ìš”.");

            

            const btn = document.getElementById('generate-ai-btn');

            btn.disabled = true;

            btn.innerText = "ìƒì„± ì¤‘...";



            try {

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${GEMINI_API_KEY}`, {

                    method: 'POST',

                    headers: { 'Content-Type': 'application/json' },

                    body: JSON.stringify({

                        contents: [{ parts: [{ text: `Generate 5 English sentences with 'Objective case relative pronouns' (who, whom, which, that) about: ${prompt}. Each sentence must be a single string. Output format: JSON array of objects with keys "en" and "ko". Example: [{"en": "The book that I read was fun", "ko": "ë‚´ê°€ ì½ì€ ì±…ì€ ì¬ë¯¸ìˆì—ˆë‹¤"}]` }] }],

                        generationConfig: { responseMimeType: "application/json" }

                    })

                });

                const data = await response.json();

                const items = JSON.parse(data.candidates[0].content.parts[0].text);

                

                const batch = writeBatch(db);

                items.forEach(q => {

                    const ref = doc(collection(db, 'artifacts', appId, 'public', 'data', 'quizzes'));

                    batch.set(ref, { ...q, createdAt: Date.now() });

                });

                await batch.commit();

                document.getElementById('ai-prompt').value = "";

            } catch (e) { 

                console.error(e); 

                alert("AI ìƒì„± ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."); 

            } finally {

                btn.disabled = false;

                btn.innerText = "ìƒì„±";

            }

        };



        function updateAdminList() {

            const list = document.getElementById('admin-quiz-list');

            list.innerHTML = quizzes.map(q => `

                <div class="flex justify-between items-center p-4 bg-slate-50 rounded-2xl border border-slate-100">

                    <div class="text-sm">

                        <p class="font-black text-indigo-600">${q.en}</p>

                        <p class="text-slate-400 font-bold">${q.ko}</p>

                    </div>

                    <button onclick="window.delQuiz('${q.id}')" class="p-2 text-red-400 hover:text-red-600 font-black">ì‚­ì œ</button>

                </div>

            `).join('');

        }



        window.delQuiz = async (id) => { 

            if(id && confirm("ì‚­ì œí• ê¹Œìš”?")) {

                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'quizzes', id)); 

            }

        };



        // 6. UI ì´ë²¤íŠ¸

        document.getElementById('rank-btn').onclick = () => document.getElementById('rank-modal').classList.add('active');

        document.getElementById('rank-close').onclick = () => document.getElementById('rank-modal').classList.remove('active');

        document.getElementById('admin-btn').onclick = () => document.getElementById('admin-modal').classList.add('active');

        document.getElementById('admin-close').onclick = () => document.getElementById('admin-modal').classList.remove('active');

        document.getElementById('reset-btn').onclick = loadQuiz;

    </script>

</body>

</html>
